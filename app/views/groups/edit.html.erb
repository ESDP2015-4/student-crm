<h3>Редактирование группы</h3>

<% if current_user.has_any_role? :admin, :manager %>
    <%= simple_form_for @group do |f| %>

        <% if @group.errors.any? %>
            <div class="errors">
              Total errors: <%= @group.errors.count %>
              <ul>
                <% @group.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                <% end %>
              </ul>
            </div>
        <% end %>

        <div>
          <%= f.label 'Название группы' %><br/>
          <%= f.text_field :name, class: 'form-control' %>
        </div>
        <br/>
        <div>
          <% if Group.find(params[:id]).course.ends_at.as_json < Date.today.as_json %>
              <fieldset disabled>
                <%= f.label 'Курс (уже завершен)' %>
                <%= f.collection_select :course_id, Course.all, :id, :name, {}, class: 'form-control', id: 'disabledSelect' %>
              </fieldset>
          <% else %>
              <%= f.label 'Курс' %>
              <%= f.collection_select :course_id, Course.find_by_sql("SELECT id, name, ends_at FROM courses WHERE ends_at > '#{Date.today.as_json}'"), :id, :name, {}, class: 'form-control' %>
          <% end %>
        </div>
        <hr>
        <div>
          <%= f.submit class: 'btn btn-primary btn-lg' %>
        </div>
    <% end %>
<% end %>
